<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cart">
	<insert id="addCart" parameterType="cartlistDto">
 		insert into cartList
 		 (cartNum, userId, itemNum, cartStock)
    	 values (cartList_seq.nextval, #{userId}, #{itemNum}, #{cartStock})
	</insert>
	
	<select id="cartList" resultType="cartlistDto">
		select
     		row_number() over(order by c.cartNum desc) as num,
     		c.cartNum, c.userId, c.itemNum, c.cartStock, c.addDate,
    		 i.itemName, i.itemPrice, i.itemImg
		 from cartList c
    		 inner join tbl_items i
    		     on c.itemNum = i.itemNum   
   		  where c.userId = #{userId}	
	</select>
	
	<delete id="deleteCart">
		delete from cartList
		where cartNum=#{cartNum}
	</delete>
	
	<update id="modifyCart">
		update cartList
		set cartStock=#{cartStock}
		where userId=#{userId} and itemNum=#{itemNum}
	</update>
	
	<select id="countCart" resultType="int">
		select count(*) from cartList
		where userId=#{userId} and itemNum=#{itemNum}
	</select>
	
	<update id="updateCart">
		update cartList
		set cartStock=cartStock + #{cartStock}
		where userId=#{userId}
		and itemNum=#{itemNum}
	</update>
	
</mapper>